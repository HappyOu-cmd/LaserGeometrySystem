#!/usr/bin/env python3
"""
üîß MODBUS SLAVE SERVER - –ü—Ä–æ—Å—Ç–æ–π —Å–µ—Ä–≤–µ—Ä —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏

–†–µ–∞–ª–∏–∑—É–µ—Ç Modbus TCP —Å–µ—Ä–≤–µ—Ä —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ –¥–ª—è HMI –ø–∞–Ω–µ–ª–∏:
- Holding Registers (40001-40014) - –∫–æ–º–∞–Ω–¥—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- Input Registers (30001-30012) - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π
"""

import time
import threading
import logging
import struct
try:
    # –î–ª—è pymodbus 3.5.4
    from pymodbus.server import StartTcpServer
    from pymodbus.device import ModbusDeviceIdentification
    from pymodbus.datastore import ModbusSequentialDataBlock, ModbusSlaveContext, ModbusServerContext
    print("OK –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pymodbus 3.x")
except ImportError:
    try:
        # –î–ª—è pymodbus 2.x (fallback)
        from pymodbus.server.sync import StartTcpServer
        from pymodbus.device import ModbusDeviceIdentification
        from pymodbus.datastore import ModbusSequentialDataBlock, ModbusSlaveContext, ModbusServerContext
        print("OK –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pymodbus 2.x")
    except ImportError:
        print("ERROR –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ pymodbus. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ: pip install pymodbus")
        exit(1)

import tkinter as tk
from tkinter import ttk, messagebox, scrolledtext

def float_to_doubleword(value):
    """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è float –≤ –¥–≤–∞ 16-–±–∏—Ç–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–∞ (DoubleWord)"""
    # –£–ø–∞–∫–æ–≤—ã–≤–∞–µ–º float –≤ 4 –±–∞–π—Ç–∞, –∑–∞—Ç–µ–º —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∫–∞–∫ –¥–≤–∞ uint16
    packed = struct.pack('>f', value)  # Big-endian float
    high_word, low_word = struct.unpack('>HH', packed)
    return low_word, high_word  # –ú–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ –ø–µ—Ä–≤–æ–µ

def doubleword_to_float(low_word, high_word):
    """–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –¥–≤—É—Ö 16-–±–∏—Ç–Ω—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –≤ float"""
    # –£–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –¥–≤–∞ uint16 –≤ 4 –±–∞–π—Ç–∞, –∑–∞—Ç–µ–º —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ–º –∫–∞–∫ float
    packed = struct.pack('>HH', high_word, low_word)
    return struct.unpack('>f', packed)[0]

class ModbusSlaveServer:
    """–ü—Ä–æ—Å—Ç–æ–π Modbus Slave —Å–µ—Ä–≤–µ—Ä —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏"""
    
    def __init__(self, enable_gui=True):
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
        self.modbus_port = 502
        self.slave_id = 1
        self.enable_gui = enable_gui
        
        # Modbus —Å–µ—Ä–≤–µ—Ä
        self.modbus_server = None
        self.server_thread = None
        self.is_server_running = False
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
        self.init_registers()
        
        # GUI (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω)
        if self.enable_gui:
            self.setup_gui()
            # –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
            self.monitor_registers()
        
    def init_registers(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Modbus —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤"""
        
        # === HOLDING REGISTERS - –ö–æ–º–∞–Ω–¥—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===
        self.holding_registers = {
            # 40001: CMD –∫–æ–º–∞–Ω–¥–∞ –æ—Ç –ü–õ–ö
            0: 0,    # CMD –∫–æ–º–∞–Ω–¥–∞ (0=—Å—Ç–æ–ø, 10=—Å—Ç–µ–Ω–∫–∞, 11=—Ñ–ª–∞–Ω–µ—Ü, 12=–¥–Ω–æ)
            
            # 40002, 40003: –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            1: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            2: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40004, 40005: –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (DoubleWord float)  
            3: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            4: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40006, 40007: –≠—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (DoubleWord float)
            5: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            6: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40008, 40009: –≠—Ç–∞–ª–æ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ (DoubleWord float)
            7: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            8: 0.0,  # –≠—Ç–∞–ª–æ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40010, 40011: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,2 (DoubleWord float)
            9: 50.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,2 (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            10: 0.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,2 (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40012, 40013: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,3 (DoubleWord float)
            11: 50.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,3 (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            12: 0.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,3 (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40014, 40015: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 4 –∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é (DoubleWord float)
            13: 50.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫ 4 –∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            14: 0.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫ 4 –∏ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å—é (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40016, 40017: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 1 –∏ —Ü–µ–Ω—Ç—Ä–æ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è (DoubleWord float)
            15: 50.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 1 –∏ —Ü–µ–Ω—Ç—Ä–æ–º (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            16: 0.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 1 –∏ —Ü–µ–Ω—Ç—Ä–æ–º (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40018, 40019: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 2 –∏ —Ü–µ–Ω—Ç—Ä–æ–º –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è (DoubleWord float)
            17: 50.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 2 –∏ —Ü–µ–Ω—Ç—Ä–æ–º (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            18: 0.0,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–æ–º 2 –∏ —Ü–µ–Ω—Ç—Ä–æ–º (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # === –†–ï–ì–ò–°–¢–†–´ –î–õ–Ø –ò–ó–ú–ï–†–ï–ù–ò–Ø –í–´–°–û–¢–´ ===
            # 40052, 40053: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –æ—Ç –¥–æ–º–∞—à–Ω–µ–π –ø–æ–∑–∏—Ü–∏–∏ (DoubleWord integer)
            51: 0,     # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
            52: 0,     # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
            
            # 40054: –ò–º–ø—É–ª—å—Å–æ–≤ –Ω–∞ 1 –º–º
            53: 1000,  # –ò–º–ø—É–ª—å—Å–æ–≤ –Ω–∞ 1 –º–º (16-bit integer)
            
            # 40055, 40056: –î–∏—Å—Ç–∞–Ω—Ü–∏—è –≤ –º–º –¥–æ –Ω–∞—á–∞–ª–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ (DoubleWord float)
            54: 0.0,   # –î–∏—Å—Ç–∞–Ω—Ü–∏—è –≤ –º–º –¥–æ –Ω–∞—á–∞–ª–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            55: 0.0,   # –î–∏—Å—Ç–∞–Ω—Ü–∏—è –≤ –º–º –¥–æ –Ω–∞—á–∞–ª–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40057, 40058: –ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ (DoubleWord float)
            56: 0.0,   # –ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            57: 0.0,   # –ò–∑–º–µ—Ä–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40024: –°–±—Ä–æ—Å –æ—à–∏–±–æ–∫ (1 = —Å–±—Ä–æ—Å–∏—Ç—å —Ñ–ª–∞–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ 0)
            23: 0,     # –°–±—Ä–æ—Å –æ—à–∏–±–æ–∫ (0=–Ω–µ—Ç, 1=—Å–±—Ä–æ—Å–∏—Ç—å)
            
            # 40100: –°–º–µ–Ω–∞ (–≤–≤–æ–¥–∏—Ç—Å—è –Ω–∞ HMI)
            99: 1,     # –°–º–µ–Ω–∞ (–Ω–æ–º–µ—Ä —Å–º–µ–Ω—ã)
            
            # 40101: –ù–æ–º–µ—Ä –∏–∑–¥–µ–ª–∏—è (–∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ 12‚Üí0)
            100: 0,    # –ù–æ–º–µ—Ä –∏–∑–¥–µ–ª–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á—ë—Ç)
            
            # 40049: –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (0=–≤—Å–µ, 1=—Å—Ä–µ–¥–Ω–µ–µ, 2=–º–∞–∫—Å+—Å—Ä–µ–¥, 3=–º–∏–Ω+—Å—Ä–µ–¥)
            48: 0,     # –†–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - –ø—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ)
            
            # 40050: –î–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª–æ–≤–Ω–æ-–≥–æ–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫
            49: 0,     # –î–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª–æ–≤–Ω–æ-–≥–æ–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫
            
            # 40051: –î–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–æ–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫
            50: 0,     # –î–æ–ø—É—Å—Ç–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–æ–¥–Ω—ã—Ö –æ—à–∏–±–æ–∫

            #40057,40058: 
            56: 0.0,  # –∏–∑–º–µ—Ä–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            57: 0.0,  # –∏–∑–º–µ—Ä–µ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∏ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            # === –†–ê–°–®–ò–†–ï–ù–ù–´–ï HOLDING –†–ï–ì–ò–°–¢–†–´ 40352-40403 ===
            # –ü–æ—Ä–æ–≥–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
            
            # 40352, 40353: –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) (DoubleWord float)
            351: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            352: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40354, 40355: –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            353: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            354: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40356, 40357: –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            355: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            356: 0.0,  # –í–µ—Ä—Ö–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40358, 40359: –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) (DoubleWord float)
            357: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            358: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40360, 40361: –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            359: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            360: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40362, 40363: –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            361: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            362: 0.0,  # –ù–∏–∂–Ω—è—è —Å—Ç–µ–Ω–∫–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40364, 40365: –î–Ω–æ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) (DoubleWord float)
            363: 0.0,  # –î–Ω–æ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            364: 0.0,  # –î–Ω–æ (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40366, 40367: –î–Ω–æ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            365: 0.0,  # –î–Ω–æ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            366: 0.0,  # –î–Ω–æ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40368, 40369: –î–Ω–æ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            367: 0.0,  # –î–Ω–æ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            368: 0.0,  # –î–Ω–æ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40370, 40371: –§–ª–∞–Ω–µ—Ü (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) (DoubleWord float)
            369: 0.0,  # –§–ª–∞–Ω–µ—Ü (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            370: 0.0,  # –§–ª–∞–Ω–µ—Ü (—Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40372, 40373: –§–ª–∞–Ω–µ—Ü (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            371: 0.0,  # –§–ª–∞–Ω–µ—Ü (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            372: 0.0,  # –§–ª–∞–Ω–µ—Ü (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40374, 40375: –§–ª–∞–Ω–µ—Ü (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            373: 0.0,  # –§–ª–∞–Ω–µ—Ü (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            374: 0.0,  # –§–ª–∞–Ω–µ—Ü (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40376, 40377: –í—ã—Å–æ—Ç–∞ (–±–∞–∑–æ–≤–∞—è) (DoubleWord float)
            375: 0.0,  # –í—ã—Å–æ—Ç–∞ (–±–∞–∑–æ–≤–∞—è) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            376: 0.0,  # –í—ã—Å–æ—Ç–∞ (–±–∞–∑–æ–≤–∞—è) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40378, 40379: –í—ã—Å–æ—Ç–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            377: 0.0,  # –í—ã—Å–æ—Ç–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            378: 0.0,  # –í—ã—Å–æ—Ç–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40380, 40381: –í—ã—Å–æ—Ç–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            379: 0.0,  # –í—ã—Å–æ—Ç–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            380: 0.0,  # –í—ã—Å–æ—Ç–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40382, 40383: –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–±–∞–∑–æ–≤–æ–µ) (DoubleWord float)
            381: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–±–∞–∑–æ–≤–æ–µ) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            382: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–±–∞–∑–æ–≤–æ–µ) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40384, 40385: –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            383: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            384: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40386, 40387: –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            385: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            386: 0.0,  # –î–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40388, 40389: –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–±–∞–∑–æ–≤–æ–µ) (DoubleWord float)
            387: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–±–∞–∑–æ–≤–æ–µ) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            388: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–±–∞–∑–æ–≤–æ–µ) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40390, 40391: –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            389: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            390: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (—É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40392, 40393: –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            391: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            392: 0.0,  # –î–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (–Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40394, 40395: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∫—Ä–∞—è (DoubleWord float)
            393: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∫—Ä–∞—è - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            394: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –∫—Ä–∞—è - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40396, 40397: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –¥–Ω–∞ (DoubleWord float)
            395: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –¥–Ω–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            396: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –¥–Ω–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40398, 40399: –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            397: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            398: 0.0,  # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40400, 40401: –¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            399: 0.0,  # –¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            400: 0.0,  # –¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 40402, 40403: –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) (DoubleWord float)
            401: 0.0,  # –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            402: 0.0,  # –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ–≥–æ–¥–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
        }
        
        # === INPUT REGISTERS - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π ===
        self.input_registers = {
            # 30001, 30002: –¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –î–∞—Ç—á–∏–∫ 1 (DoubleWord float)
            0: 0.0,  # –î–∞—Ç—á–∏–∫ 1 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            1: 0.0,  # –î–∞—Ç—á–∏–∫ 1 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30003, 30004: –¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –î–∞—Ç—á–∏–∫ 2 (DoubleWord float)
            2: 0.0,  # –î–∞—Ç—á–∏–∫ 2 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            3: 0.0,  # –î–∞—Ç—á–∏–∫ 2 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30005, 30006: –¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –î–∞—Ç—á–∏–∫ 3 (DoubleWord float)
            4: 0.0,  # –î–∞—Ç—á–∏–∫ 3 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            5: 0.0,  # –î–∞—Ç—á–∏–∫ 3 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30007, 30008: –¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ –î–∞—Ç—á–∏–∫ 4 (DoubleWord float)
            6: 0.0,  # –î–∞—Ç—á–∏–∫ 4 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            7: 0.0,  # –î–∞—Ç—á–∏–∫ 4 - —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30009: –§–ª–∞–≥ —Ü–∏–∫–ª–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è (—Å—Ç–∞—Ç—É—Å)
            8: 0,    # –§–ª–∞–≥ —Ü–∏–∫–ª–∞ (0=–≥–æ—Ç–æ–≤, 9/90/91=–≤—ã—Å–æ—Ç–∞, 10/11/110=—Å—Ç–µ–Ω–∫–∞, 12/13/112=—Ñ–ª–∞–Ω–µ—Ü, 14/15/114=–¥–Ω–æ, 16/116=–∫–∞—á–µ—Å—Ç–≤–æ)
            
            # 30010, 30011: –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            9: 0.0,   # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            10: 0.0,  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30012, 30013: –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            11: 0.0,  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            12: 0.0,  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30014, 30015: –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (DoubleWord float)
            13: 0.0,  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–º–º) - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            14: 0.0,  # –ü–æ—Å–ª–µ–¥–Ω—è—è —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (–º–º) - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # === –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–ó–ú–ï–†–ï–ù–ò–ô (MAX, AVG, MIN) ===
            
            # 30016, 30017: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            15: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            16: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30018, 30019: –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            17: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            18: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30020, 30021: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            19: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            20: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –≤–µ—Ä—Ö–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30022, 30023: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            21: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            22: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30024, 30025: –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            23: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            24: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30026, 30027: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ (DoubleWord float)
            25: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            26: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –Ω–∏–∂–Ω–µ–π —Å—Ç–µ–Ω–∫–∏ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30028, 30029: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (DoubleWord float)
            27: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            28: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30030, 30031: –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (DoubleWord float)
            29: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            30: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30032, 30033: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ (DoubleWord float)
            31: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            32: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30034, 30035: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            33: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            34: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30036, 30037: –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            35: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            36: 0.0,  # –°—Ä–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30038, 30039: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            37: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            38: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30040, 30041: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ (DoubleWord float)
            39: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            40: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30042, 30043: –°—Ä–µ–¥–Ω—è—è –≤—ã—Å–æ—Ç–∞ (DoubleWord float)
            41: 0.0,  # –°—Ä–µ–¥–Ω—è—è –≤—ã—Å–æ—Ç–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            42: 0.0,  # –°—Ä–µ–¥–Ω—è—è –≤—ã—Å–æ—Ç–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30044, 30045: –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ (DoubleWord float)
            43: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            44: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30046, 30047: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (DoubleWord float)
            45: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            46: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30048, 30049: –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (DoubleWord float)
            47: 0.0,  # –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            48: 0.0,  # –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30050, 30051: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ (DoubleWord float)
            49: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            50: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä –∫–æ—Ä–ø—É—Å–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30052, 30053: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            51: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            52: 0.0,  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30054, 30055: –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            53: 0.0,  # –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            54: 0.0,  # –°—Ä–µ–¥–Ω–∏–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # 30056, 30057: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ (DoubleWord float)
            55: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - –º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ
            56: 0.0,  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä —Ñ–ª–∞–Ω—Ü–∞ - —Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ
            
            # === –°–ß–Å–¢–ß–ò–ö–ò –ò–ó–î–ï–õ–ò–ô –ó–ê –°–ú–ï–ù–£ ===
            # 30101: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–¥–µ–ª–∏–π –∑–∞ —Å–º–µ–Ω—É
            100: 0,   # –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–¥–µ–ª–∏–π
            
            # 30102: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–¥–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∑–∞ —Å–º–µ–Ω—É
            101: 0,   # –ì–æ–¥–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è
            
            # 30103: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∑–∞ —Å–º–µ–Ω—É
            102: 0,   # –£—Å–ª–æ–≤–Ω–æ-–Ω–µ–≥–æ–¥–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è
            
            # 30104: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–æ–¥–Ω—ã—Ö –∏–∑–¥–µ–ª–∏–π –∑–∞ —Å–º–µ–Ω—É
            103: 0,   # –ù–µ–≥–æ–¥–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è
        }
        
        # –°–æ–∑–¥–∞–Ω–∏–µ Modbus datastore
        self.create_modbus_context()
        
    def create_modbus_context(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ Modbus —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏"""
        
        # Holding Registers (—Ñ—É–Ω–∫—Ü–∏–∏ 3, 6, 16) - 40001-40500 (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω)
        holding_block = ModbusSequentialDataBlock(1, [0] * 500)
        
        # Input Registers (—Ñ—É–Ω–∫—Ü–∏—è 4) - 30001-30500 (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω)
        input_block = ModbusSequentialDataBlock(1, [0] * 500)
        
        # –ó–∞–ø–æ–ª–Ω—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
        for addr, value in self.holding_registers.items():
            if isinstance(value, float):
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º float –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –¥–ª—è Modbus (—É–º–Ω–æ–∂–∞–µ–º –Ω–∞ 1000)
                int_value = int(value * 1000)
                holding_block.setValues(addr + 1, [int_value])
            else:
                holding_block.setValues(addr + 1, [int(value)])
            
        for addr, value in self.input_registers.items():
            if isinstance(value, float):
                # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º float –≤ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ –¥–ª—è Modbus (—É–º–Ω–æ–∂–∞–µ–º –Ω–∞ 1000)
                int_value = int(value * 1000)
                input_block.setValues(addr + 1, [int_value])
            else:
                input_block.setValues(addr + 1, [int(value)])
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ slave
        self.slave_context = ModbusSlaveContext(
            di=None,  # Discrete Inputs
            co=None,  # Coils
            hr=holding_block,  # Holding Registers
            ir=input_block     # Input Registers
        )
        
        # –ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–µ—Ä–≤–µ—Ä–∞
        self.server_context = ModbusServerContext(slaves={self.slave_id: self.slave_context}, single=False)
        
    def setup_gui(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ GUI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
        self.root = tk.Tk()
        self.root.title("MODBUS SLAVE SERVER - –†–µ–≥–∏—Å—Ç—Ä—ã –¥–ª—è HMI")
        self.root.geometry("1000x700")
        self.root.resizable(True, True)
        
        # –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º
        main_frame = ttk.Frame(self.root)
        main_frame.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ttk.Label(main_frame, text="MODBUS SLAVE SERVER", 
                               font=("Arial", 16, "bold"))
        title_label.pack(pady=10)
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
        self.setup_server_frame(main_frame)
        
        # –†–µ–≥–∏—Å—Ç—Ä—ã
        self.setup_registers_frame(main_frame)
        
        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        self.setup_control_frame(main_frame)
        
        # –õ–æ–≥
        self.setup_log_frame(main_frame)
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
        self.root.protocol("WM_DELETE_WINDOW", self.on_closing)
        
    def setup_server_frame(self, parent):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞"""
        server_frame = ttk.LabelFrame(parent, text="–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Modbus TCP —Å–µ—Ä–≤–µ—Ä–∞", padding=10)
        server_frame.pack(fill=tk.X, pady=5)
        
        settings_row = ttk.Frame(server_frame)
        settings_row.pack(fill=tk.X, pady=5)
        
        ttk.Label(settings_row, text="TCP –ø–æ—Ä—Ç:").pack(side=tk.LEFT)
        self.port_var = tk.StringVar(value=str(self.modbus_port))
        ttk.Entry(settings_row, textvariable=self.port_var, width=8).pack(side=tk.LEFT, padx=5)
        
        ttk.Label(settings_row, text="Slave ID:").pack(side=tk.LEFT, padx=(20,0))
        self.slave_var = tk.StringVar(value=str(self.slave_id))
        ttk.Entry(settings_row, textvariable=self.slave_var, width=8).pack(side=tk.LEFT, padx=5)
        
        # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
        self.server_status = ttk.Label(settings_row, text="[STOP] –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω", 
                                      foreground="red", font=("Arial", 10, "bold"))
        self.server_status.pack(side=tk.RIGHT, padx=10)
        
    def setup_registers_frame(self, parent):
        """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤"""
        reg_frame = ttk.LabelFrame(parent, text="Modbus —Ä–µ–≥–∏—Å—Ç—Ä—ã", padding=10)
        reg_frame.pack(fill=tk.BOTH, expand=True, pady=5)
        
        # Notebook –¥–ª—è —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
        notebook = ttk.Notebook(reg_frame)
        notebook.pack(fill=tk.BOTH, expand=True)
        
        # Holding Registers
        holding_frame = ttk.Frame(notebook)
        notebook.add(holding_frame, text="Holding Registers (40001+)")
        
        # Input Registers
        input_frame = ttk.Frame(notebook)
        notebook.add(input_frame, text="Input Registers (30001+)")
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
        self.create_registers_table(holding_frame, "holding")
        self.create_registers_table(input_frame, "input")
        
    def create_registers_table(self, parent, reg_type):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤"""
        
        # –§—Ä–µ–π–º –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
        table_frame = ttk.Frame(parent)
        table_frame.pack(fill=tk.BOTH, expand=True, padx=5, pady=5)
        
        # Treeview –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã
        columns = ("–†–µ–≥–∏—Å—Ç—Ä", "–ù–∞–∑–≤–∞–Ω–∏–µ", "–ó–Ω–∞—á–µ–Ω–∏–µ", "–ï–¥–∏–Ω–∏—Ü—ã", "–û–ø–∏—Å–∞–Ω–∏–µ")
        tree = ttk.Treeview(table_frame, columns=columns, show="headings", height=12)
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–æ–Ω–æ–∫
        tree.heading("–†–µ–≥–∏—Å—Ç—Ä", text="–†–µ–≥–∏—Å—Ç—Ä")
        tree.heading("–ù–∞–∑–≤–∞–Ω–∏–µ", text="–ù–∞–∑–≤–∞–Ω–∏–µ")
        tree.heading("–ó–Ω–∞—á–µ–Ω–∏–µ", text="–ó–Ω–∞—á–µ–Ω–∏–µ")
        tree.heading("–ï–¥–∏–Ω–∏—Ü—ã", text="–ï–¥–∏–Ω–∏—Ü—ã")
        tree.heading("–û–ø–∏—Å–∞–Ω–∏–µ", text="–û–ø–∏—Å–∞–Ω–∏–µ")
        
        tree.column("–†–µ–≥–∏—Å—Ç—Ä", width=80)
        tree.column("–ù–∞–∑–≤–∞–Ω–∏–µ", width=200)
        tree.column("–ó–Ω–∞—á–µ–Ω–∏–µ", width=100)
        tree.column("–ï–¥–∏–Ω–∏—Ü—ã", width=80)
        tree.column("–û–ø–∏—Å–∞–Ω–∏–µ", width=300)
        
        # –°–∫—Ä–æ–ª–ª–±–∞—Ä
        scrollbar = ttk.Scrollbar(table_frame, orient=tk.VERTICAL, command=tree.yview)
        tree.configure(yscrollcommand=scrollbar.set)
        
        tree.pack(side=tk.LEFT, fill=tk.BOTH, expand=True)
        scrollbar.pack(side=tk.RIGHT, fill=tk.Y)
        
        # –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
        if reg_type == "holding":
            self.holding_tree = tree
            self.populate_holding_registers()
        else:
            self.input_tree = tree
            self.populate_input_registers()
            
    def populate_holding_registers(self):
        """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Holding Registers"""
        registers_data = [
            ("40001", "CMD –∫–æ–º–∞–Ω–¥–∞ –æ—Ç –ü–õ–ö", "0", "", "0=—Å—Ç–æ–ø, 10=—Å—Ç–µ–Ω–∫–∞, 11=—Ñ–ª–∞–Ω–µ—Ü, 12=–¥–Ω–æ"),
            ("40002", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏", "0.0", "–º–º", "DoubleWord float"),
            ("40003", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40004", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞", "0.0", "–º–º", "DoubleWord float"),
            ("40005", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40006", "–≠—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä", "0.0", "–º–º", "DoubleWord float"),
            ("40007", "–≠—Ç–∞–ª–æ–Ω–Ω—ã–π –¥–∏–∞–º–µ—Ç—Ä", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40008", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞", "0.0", "–º–º", "DoubleWord float"),
            ("40009", "–≠—Ç–∞–ª–æ–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40010", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,2", "50.0", "–º–º", "DoubleWord float"),
            ("40011", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,2", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40012", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,3", "50.0", "–º–º", "DoubleWord float"),
            ("40013", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –¥–∞—Ç—á–∏–∫–∞–º–∏ 1,3", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40014", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 4 - –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å", "50.0", "–º–º", "DoubleWord float"),
            ("40015", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 4 - –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40016", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 1 - —Ü–µ–Ω—Ç—Ä", "50.0", "–º–º", "DoubleWord float"),
            ("40017", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 1 - —Ü–µ–Ω—Ç—Ä", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("40018", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 2 - —Ü–µ–Ω—Ç—Ä", "50.0", "–º–º", "DoubleWord float"),
            ("40019", "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 2 - —Ü–µ–Ω—Ç—Ä", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
        ]
        
        for reg_data in registers_data:
            self.holding_tree.insert("", tk.END, values=reg_data)
            
    def populate_input_registers(self):
        """–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ Input Registers"""
        registers_data = [
            ("30001", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 1", "0.0", "–º–º", "DoubleWord float"),
            ("30002", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 1", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30003", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 2", "0.0", "–º–º", "DoubleWord float"),
            ("30004", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 2", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30005", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 3", "0.0", "–º–º", "DoubleWord float"),
            ("30006", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 3", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30007", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 4", "0.0", "–º–º", "DoubleWord float"),
            ("30008", "–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–∞—Ç—á–∏–∫ 4", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30010", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏", "0.0", "–º–º", "DoubleWord float"),
            ("30011", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30012", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞", "0.0", "–º–º", "DoubleWord float"),
            ("30013", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
            ("30014", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞", "0.0", "–º–º", "DoubleWord float"),
            ("30015", "–ü–æ—Å–ª–µ–¥–Ω—è—è —Ç–æ–ª—â–∏–Ω–∞ –¥–Ω–∞", "0.0", "–º–º", "DoubleWord float (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)"),
        ]
        
        for reg_data in registers_data:
            self.input_tree.insert("", tk.END, values=reg_data)
            
    def setup_control_frame(self, parent):
        """–ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"""
        control_frame = ttk.Frame(parent)
        control_frame.pack(fill=tk.X, pady=10)
        
        # –ö–Ω–æ–ø–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞
        ttk.Button(control_frame, text="START –ó–∞–ø—É—Å—Ç–∏—Ç—å Modbus —Å–µ—Ä–≤–µ—Ä", 
                  command=self.start_modbus_server).pack(side=tk.LEFT, padx=5)
        ttk.Button(control_frame, text="STOP –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–µ—Ä", 
                  command=self.stop_modbus_server).pack(side=tk.LEFT, padx=5)
        
        # –¢–µ—Å—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
        ttk.Button(control_frame, text="TEST –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ", 
                  command=self.set_test_data).pack(side=tk.LEFT, padx=20)
        
        # –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞
        ttk.Button(control_frame, text="EXIT –í—ã—Ö–æ–¥", 
                  command=self.on_closing).pack(side=tk.RIGHT, padx=5)
        
    def setup_log_frame(self, parent):
        """–õ–æ–≥ —Å–æ–æ–±—â–µ–Ω–∏–π"""
        log_frame = ttk.LabelFrame(parent, text="–õ–æ–≥ —Å–æ–±—ã—Ç–∏–π", padding=5)
        log_frame.pack(fill=tk.X, pady=5)
        
        self.log_text = scrolledtext.ScrolledText(log_frame, height=8, width=80)
        self.log_text.pack(fill=tk.BOTH, expand=True)
        
    def log_message(self, message):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–≥"""
        timestamp = time.strftime("%H:%M:%S")
        log_entry = f"[{timestamp}] {message}"
        
        if self.enable_gui and hasattr(self, 'log_text'):
            self.log_text.insert(tk.END, log_entry + "\n")
            self.log_text.see(tk.END)
            
            # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –ª–æ–≥–∞
            lines = self.log_text.get("1.0", tk.END).split('\n')
            if len(lines) > 100:
                self.log_text.delete("1.0", "10.0")
        else:
            # –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å –µ—Å–ª–∏ GUI –æ—Ç–∫–ª—é—á–µ–Ω
            print(log_entry)
            
    def start_modbus_server(self):
        """–ó–∞–ø—É—Å–∫ Modbus TCP —Å–µ—Ä–≤–µ—Ä–∞"""
        try:
            if self.enable_gui:
                self.modbus_port = int(self.port_var.get())
                self.slave_id = int(self.slave_var.get())
            # –ï—Å–ª–∏ GUI –æ—Ç–∫–ª—é—á–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            
            # –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –Ω–æ–≤—ã–º slave_id
            self.create_modbus_context()
            
            # –°–æ–∑–¥–∞–Ω–∏–µ identity
            identity = ModbusDeviceIdentification()
            identity.VendorName = 'RIFTEK'
            identity.ProductCode = 'RF602'
            identity.VendorUrl = 'https://riftek.com'
            identity.ProductName = 'Modbus Slave Server'
            identity.ModelName = 'RF602 Registers'
            identity.MajorMinorRevision = '1.0'
            
            # –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ
            self.server_thread = threading.Thread(
                target=self.run_modbus_server,
                args=(self.modbus_port, identity),
                daemon=True
            )
            self.server_thread.start()
            
            self.is_server_running = True
            
            if self.enable_gui and hasattr(self, 'server_status'):
                self.server_status.config(text=f"[RUN] –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç :{self.modbus_port}", foreground="green")
            
            self.log_message(f"Modbus TCP —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É {self.modbus_port}, Slave ID: {self.slave_id}")
            
        except Exception as e:
            self.log_message(f"–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: {e}")
            if self.enable_gui:
                messagebox.showerror("–û—à–∏–±–∫–∞", f"–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: {e}")
            
    def run_modbus_server(self, port, identity):
        """–ó–∞–ø—É—Å–∫ Modbus —Å–µ—Ä–≤–µ—Ä–∞"""
        try:
            self.log_message(f"–ó–∞–ø—É—Å–∫ TCP —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ 0.0.0.0:{port}")
            # –î–ª—è pymodbus 3.5.4 - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
            StartTcpServer(
                context=self.server_context, 
                identity=identity, 
                address=("0.0.0.0", port)
            )
        except Exception as e:
            self.log_message(f"–û—à–∏–±–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞: {e}")
            print(f"–î–µ—Ç–∞–ª—å–Ω–∞—è –æ—à–∏–±–∫–∞: {e}")  # –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
            
    def stop_modbus_server(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∫–∞ Modbus —Å–µ—Ä–≤–µ—Ä–∞"""
        self.is_server_running = False
        
        if self.enable_gui and hasattr(self, 'server_status'):
            self.server_status.config(text="[STOP] –°–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω", foreground="red")
        
        self.log_message("Modbus —Å–µ—Ä–≤–µ—Ä –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        
    def set_test_data(self):
        """–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–≥–∏—Å—Ç—Ä—ã"""
        try:
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Input Registers (–∏–º–∏—Ç–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–æ–≤)
            test_input_data = {
                0: 12.5,   # 30001: –î–∞—Ç—á–∏–∫ 1 = 12.5 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                1: 0.0,    # 30002: –î–∞—Ç—á–∏–∫ 1 = 12.5 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                2: 8.3,    # 30003: –î–∞—Ç—á–∏–∫ 2 = 8.3 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                3: 0.0,    # 30004: –î–∞—Ç—á–∏–∫ 2 = 8.3 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                4: 15.2,   # 30005: –î–∞—Ç—á–∏–∫ 3 = 15.2 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                5: 0.0,    # 30006: –î–∞—Ç—á–∏–∫ 3 = 15.2 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                6: 22.1,   # 30007: –î–∞—Ç—á–∏–∫ 4 = 22.1 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                7: 0.0,    # 30008: –î–∞—Ç—á–∏–∫ 4 = 22.1 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                9: 29.2,   # 30010: –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ = 29.2 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                10: 0.0,   # 30011: –¢–æ–ª—â–∏–Ω–∞ —Å—Ç–µ–Ω–∫–∏ = 29.2 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                11: 35.5,  # 30012: –¢–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ = 35.5 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                12: 0.0,   # 30013: –¢–æ–ª—â–∏–Ω–∞ —Ñ–ª–∞–Ω—Ü–∞ = 35.5 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                13: 18.7,  # 30014: –¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ = 18.7 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                14: 0.0,   # 30015: –¢–æ–ª—â–∏–Ω–∞ –¥–Ω–∞ = 18.7 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
            }
            
            # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è Holding Registers
            test_holding_data = {
                0: 10,     # 40001: CMD = 10 (–∏–∑–º–µ—Ä–µ–Ω–∏–µ —Å—Ç–µ–Ω–∫–∏)
                1: 30.0,   # 40002: –≠—Ç–∞–ª–æ–Ω —Å—Ç–µ–Ω–∫–∏ = 30.0 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                2: 0.0,    # 40003: –≠—Ç–∞–ª–æ–Ω —Å—Ç–µ–Ω–∫–∏ = 30.0 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                3: 20.0,   # 40004: –≠—Ç–∞–ª–æ–Ω –¥–Ω–∞ = 20.0 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                4: 0.0,    # 40005: –≠—Ç–∞–ª–æ–Ω –¥–Ω–∞ = 20.0 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
                5: 100.0,  # 40006: –≠—Ç–∞–ª–æ–Ω –¥–∏–∞–º–µ—Ç—Ä = 100.0 –º–º (–º–ª–∞–¥—à–µ–µ —Å–ª–æ–≤–æ)
                6: 0.0,    # 40007: –≠—Ç–∞–ª–æ–Ω –¥–∏–∞–º–µ—Ç—Ä = 100.0 –º–º (—Å—Ç–∞—Ä—à–µ–µ —Å–ª–æ–≤–æ)
            }
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
            for addr, value in test_input_data.items():
                self.input_registers[addr] = value
                if isinstance(value, float):
                    int_value = int(value * 1000)
                    self.slave_context.setValues(4, addr + 1, [int_value])  # –§—É–Ω–∫—Ü–∏—è 4 - Input Registers
                else:
                    self.slave_context.setValues(4, addr + 1, [int(value)])
                
            for addr, value in test_holding_data.items():
                self.holding_registers[addr] = value
                if isinstance(value, float):
                    int_value = int(value * 1000)
                    self.slave_context.setValues(3, addr + 1, [int_value])  # –§—É–Ω–∫—Ü–∏—è 3 - Holding Registers
                else:
                    self.slave_context.setValues(3, addr + 1, [int(value)])
                
            self.log_message("–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ —Ä–µ–≥–∏—Å—Ç—Ä—ã")
            
            if self.enable_gui:
                messagebox.showinfo("–£—Å–ø–µ—Ö", "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!\n\n–¢–µ–ø–µ—Ä—å HMI –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å —ç—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è.")
            
        except Exception as e:
            self.log_message(f"–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
            if self.enable_gui:
                messagebox.showerror("–û—à–∏–±–∫–∞", f"–û—à–∏–±–∫–∞: {e}")
            
    def monitor_registers(self):
        """–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ö"""
        try:
            if self.is_server_running and self.slave_context:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Holding Registers (–º–æ–≥–ª–∏ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω—ã HMI)
                for addr in self.holding_registers.keys():
                    try:
                        values = self.slave_context.getValues(3, addr + 1, 1)
                        if values and values[0] != self.holding_registers[addr]:
                            old_value = self.holding_registers[addr]
                            new_value = values[0]
                            self.holding_registers[addr] = new_value
                            self.log_message(f"–†–µ–≥–∏—Å—Ç—Ä 4000{addr+1} –∏–∑–º–µ–Ω–µ–Ω: {old_value} ‚Üí {new_value}")
                    except:
                        pass
                        
            # –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ GUI –≤–∫–ª—é—á–µ–Ω)
            if self.enable_gui:
                self.update_registers_display()
            
        except Exception as e:
            pass  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
            
        # –ü–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â—É—é –ø—Ä–æ–≤–µ—Ä–∫—É (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ GUI –≤–∫–ª—é—á–µ–Ω)
        if self.enable_gui and hasattr(self, 'root'):
            self.root.after(1000, self.monitor_registers)  # –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        
    def update_registers_display(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö"""
        try:
            # –û–±–Ω–æ–≤–ª—è–µ–º Holding Registers
            for i, item in enumerate(self.holding_tree.get_children()):
                if i < len(self.holding_registers):
                    addr = list(self.holding_registers.keys())[i]
                    value = self.holding_registers[addr]
                    
                    current_values = list(self.holding_tree.item(item, "values"))
                    current_values[2] = str(value)
                    self.holding_tree.item(item, values=current_values)
                    
            # –û–±–Ω–æ–≤–ª—è–µ–º Input Registers
            for i, item in enumerate(self.input_tree.get_children()):
                if i < len(self.input_registers):
                    addr = list(self.input_registers.keys())[i]
                    value = self.input_registers[addr]
                    
                    current_values = list(self.input_tree.item(item, "values"))
                    current_values[2] = str(value)
                    self.input_tree.item(item, values=current_values)
        except:
            pass
            
    def on_closing(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        self.stop_modbus_server()
        if self.enable_gui and hasattr(self, 'root'):
            self.root.quit()
        
    def run(self):
        """–ó–∞–ø—É—Å–∫ GUI"""
        if self.enable_gui and hasattr(self, 'root'):
            self.root.mainloop()


def main():
    """–ó–∞–ø—É—Å–∫ Modbus Slave —Å–µ—Ä–≤–µ—Ä–∞"""
    print("üöÄ –ó–∞–ø—É—Å–∫ MODBUS SLAVE SERVER...")
    print("üìä –°–µ—Ä–≤–µ—Ä —Å —Ä–µ–≥–∏—Å—Ç—Ä–∞–º–∏ –¥–ª—è HMI –ø–∞–Ω–µ–ª–∏")
    print("üîß Holding Registers: 40001-40014 (–∫–æ–º–∞–Ω–¥—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)")
    print("üìñ Input Registers: 30001-30012 (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π)")
    
    app = ModbusSlaveServer()
    app.run()


if __name__ == "__main__":
    main()
